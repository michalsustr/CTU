<?xml version="1.0" encoding="utf-8"?><!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.1//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_1.dtd'><nta><declaration>// Place global declarations here.

chan tik;
chan check;

int rpm;
int shift;
int delta;

clock x;
clock y;
clock z;</declaration><template><name x="5" y="5">RazeniTik</name><declaration>// Place local declarations here.
</declaration><location id="id0" x="-136" y="-40"></location><init ref="id0"/><transition><source ref="id0"/><target ref="id0"/><label kind="synchronisation" x="-200" y="-104">check!</label><nail x="-168" y="-72"/><nail x="-136" y="-104"/><nail x="-104" y="-72"/></transition></template><template><name>RazeniSmycka</name><location id="id1" x="72" y="-192"><name x="32" y="-232">ReleasingClutchDown</name><label kind="invariant" x="80" y="-176">x &lt;= 2000</label></location><location id="id2" x="-56" y="-192"><name x="-112" y="-232">ShiftingGearDown</name><label kind="invariant" x="-80" y="-176">x &lt;= 1200</label></location><location id="id3" x="-200" y="-192"><name x="-264" y="-232">DepressingClutchDown</name><label kind="invariant" x="-232" y="-168">x &lt;= 500</label></location><location id="id4" x="-536" y="-88"><name x="-520" y="-112">ToShiftDown</name><label kind="invariant" x="-640" y="-96">x &lt;= 500 &amp;&amp;
rpm &lt; 1400 &amp;&amp;
rpm &gt;= 1000</label></location><location id="id5" x="-312" y="-192"><name x="-344" y="-232">ShiftDown</name></location><location id="id6" x="72" y="-304"><name x="72" y="-344">ReleasingClutchUp</name><label kind="invariant" x="40" y="-280">x &lt;= 2000</label></location><location id="id7" x="-56" y="-304"><name x="-96" y="-344">ShiftingGearUp</name><label kind="invariant" x="-96" y="-280">x &lt;= 1200</label></location><location id="id8" x="-200" y="-304"><name x="-256" y="-344">DepressingClutchUp</name><label kind="invariant" x="-224" y="-280">x &lt;= 500</label></location><location id="id9" x="-992" y="-304"><name x="-1000" y="-344">Init</name></location><location id="id10" x="-464" y="-424"><name x="-504" y="-464">ToShiftUp</name><label kind="invariant" x="-440" y="-456">x &lt;= 900 &amp;&amp;
rpm &gt; 2000 &amp;&amp;
rpm &lt;= 3000</label></location><location id="id11" x="-312" y="-304"><name x="-320" y="-344">ShiftUp</name></location><location id="id12" x="-776" y="-304"><name x="-832" y="-344">Kontrola</name></location><init ref="id9"/><transition><source ref="id4"/><target ref="id5"/><label kind="guard" x="-392" y="-128">rpm &lt; 1000 || (
x &gt; 500 &amp;&amp;
rpm &lt; 1400)</label><label kind="synchronisation" x="-392" y="-152">check?</label><nail x="-416" y="-88"/><nail x="-408" y="-152"/></transition><transition><source ref="id1"/><target ref="id12"/><label kind="guard" x="-88" y="-24">x &gt; 2000</label><nail x="16" y="0"/><nail x="-704" y="0"/></transition><transition><source ref="id2"/><target ref="id1"/><label kind="guard" x="-16" y="-192">x &gt; 1200</label><label kind="assignment" x="-32" y="-216">shift := shift - 1</label></transition><transition><source ref="id3"/><target ref="id2"/><label kind="guard" x="-160" y="-192">x &gt; 500</label></transition><transition><source ref="id5"/><target ref="id3"/><label kind="guard" x="-288" y="-184">shift &gt; 1</label><label kind="assignment" x="-288" y="-168">x:=0</label></transition><transition><source ref="id5"/><target ref="id12"/><label kind="guard" x="-496" y="-64">shift == 0</label><nail x="-280" y="-40"/><nail x="-680" y="-40"/></transition><transition><source ref="id4"/><target ref="id12"/><label kind="guard" x="-680" y="-152">rpm &gt;= 1400</label><nail x="-616" y="-168"/></transition><transition><source ref="id12"/><target ref="id4"/><label kind="guard" x="-528" y="-168">rpm &lt; 1400 &amp;&amp;
rpm &gt;= 1000</label><label kind="synchronisation" x="-536" y="-184">check?</label><label kind="assignment" x="-528" y="-136">x:=0</label><nail x="-544" y="-184"/></transition><transition><source ref="id12"/><target ref="id5"/><label kind="guard" x="-440" y="-216">rpm &lt; 1000</label><label kind="synchronisation" x="-496" y="-216">check?</label><nail x="-504" y="-192"/></transition><transition><source ref="id6"/><target ref="id12"/><label kind="guard" x="-392" y="-608">x &gt; 2000</label><nail x="-48" y="-584"/><nail x="-704" y="-584"/></transition><transition><source ref="id7"/><target ref="id6"/><label kind="guard" x="-24" y="-304">x &gt; 1200</label><label kind="assignment" x="-40" y="-328">shift := shift + 1</label></transition><transition><source ref="id8"/><target ref="id7"/><label kind="guard" x="-160" y="-304">x &gt; 500</label></transition><transition><source ref="id11"/><target ref="id8"/><label kind="guard" x="-288" y="-296">shift &lt; 3</label><label kind="assignment" x="-288" y="-280">x:=0</label></transition><transition><source ref="id11"/><target ref="id12"/><label kind="guard" x="-560" y="-536">shift == 3</label><nail x="-392" y="-512"/><nail x="-680" y="-512"/></transition><transition><source ref="id9"/><target ref="id12"/><label kind="synchronisation" x="-912" y="-328">check?</label><label kind="assignment" x="-912" y="-296">shift := 0</label><nail x="-896" y="-304"/></transition><transition><source ref="id10"/><target ref="id11"/><label kind="guard" x="-440" y="-392">rpm &gt; 3000 || (
x &gt; 900 &amp;&amp;
rpm &gt; 2000)</label><label kind="synchronisation" x="-440" y="-408">check?</label><nail x="-448" y="-336"/></transition><transition><source ref="id10"/><target ref="id12"/><label kind="guard" x="-552" y="-352">rpm &lt; 2000</label><nail x="-568" y="-344"/></transition><transition><source ref="id12"/><target ref="id11"/><label kind="guard" x="-544" y="-288">rpm &gt; 3000</label><label kind="synchronisation" x="-544" y="-304">check?</label></transition><transition><source ref="id12"/><target ref="id10"/><label kind="guard" x="-608" y="-440">rpm &gt; 2000 &amp;&amp;
rpm &lt;= 3000</label><label kind="assignment" x="-608" y="-408">x:=0</label><nail x="-560" y="-384"/></transition></template><template><name>Motor</name><location id="id13" x="-240" y="-72"><name x="-248" y="-112">Init</name></location><location id="id14" x="80" y="-72"><label kind="invariant" x="104" y="-88">y &lt;= 1000</label></location><location id="id15" x="-88" y="-72"></location><init ref="id13"/><transition><source ref="id13"/><target ref="id15"/><label kind="synchronisation" x="-200" y="-152">tik?</label><label kind="assignment" x="-200" y="-128">rpm := 900,
y := 0,
delta := 0</label></transition><transition><source ref="id14"/><target ref="id15"/><label kind="guard" x="-24" y="48">y &gt;= 1000</label><label kind="assignment" x="-24" y="72">y := 0,
delta := 0</label><nail x="32" y="40"/><nail x="-32" y="40"/></transition><transition><source ref="id14"/><target ref="id15"/><label kind="guard" x="-32" y="-40">y &lt; 1000</label><nail x="32" y="-16"/><nail x="-40" y="-16"/></transition><transition><source ref="id15"/><target ref="id14"/><label kind="select" x="-56" y="-200">i: int[-500,1000]</label><label kind="guard" x="-56" y="-176">delta + i &gt;= -500 &amp;&amp;
delta + i &lt;= 1000</label><label kind="synchronisation" x="-56" y="-224">tik?</label><label kind="assignment" x="-56" y="-128">delta := delta + i,
rpm := rpm + delta</label></transition></template><template><name>MotorTik</name><location id="id16" x="-192" y="-72"></location><init ref="id16"/><transition><source ref="id16"/><target ref="id16"/><label kind="synchronisation" x="-252" y="-87">tik!</label><nail x="-240" y="-120"/><nail x="-192" y="-160"/><nail x="-144" y="-112"/></transition></template><template><name>MotorEmergency</name><location id="id17" x="48" y="184"><name x="48" y="224">StopWarning</name></location><location id="id18" x="304" y="48" color="#ffa500"><name x="328" y="24">MOTOR_STOP</name></location><location id="id19" x="304" y="-16" color="#ff0000"><name x="328" y="-48">MOTOR_BROKEN</name></location><location id="id20" x="96" y="-168"><name x="72" y="-240">FailWarning</name><label kind="invariant" x="120" y="-208">z &lt;= 10000 &amp;&amp;
rpm &gt; 5000</label></location><location id="id21" x="-32" y="-16"><name x="-136" y="-48">EmergencyOK</name></location><init ref="id21"/><transition><source ref="id17"/><target ref="id18"/><label kind="guard" x="232" y="152">rpm &lt; 700 || ( rpm &lt; 900 &amp;&amp; z &gt;= 200 )</label><label kind="synchronisation" x="232" y="136">tik?</label><nail x="200" y="152"/></transition><transition><source ref="id17"/><target ref="id21"/><label kind="guard" x="-112" y="40">rpm &gt;= 900</label><label kind="synchronisation" x="-72" y="24">tik?</label><nail x="32" y="168"/><nail x="-24" y="96"/></transition><transition><source ref="id21"/><target ref="id17"/><label kind="guard" x="56" y="104">rpm &lt; 900 &amp;&amp; rpm &gt;= 700</label><label kind="synchronisation" x="56" y="88">tik?</label><label kind="assignment" x="56" y="120">z:=0</label><nail x="48" y="96"/></transition><transition><source ref="id20"/><target ref="id19"/><label kind="guard" x="240" y="-144">rpm &gt; 7000 || ( rpm &gt; 5000 &amp;&amp; z &gt;= 10000)</label><label kind="synchronisation" x="240" y="-160">tik?</label><nail x="216" y="-136"/></transition><transition><source ref="id20"/><target ref="id21"/><label kind="guard" x="-72" y="-144">rpm &lt;= 5000</label><label kind="synchronisation" x="-72" y="-160">tik?</label><nail x="0" y="-112"/></transition><transition><source ref="id21"/><target ref="id20"/><label kind="guard" x="88" y="-120">rpm &gt; 5000 &amp;&amp;
rpm &lt;= 7000</label><label kind="synchronisation" x="88" y="-136">tik?</label><label kind="assignment" x="88" y="-88">z:=0</label><nail x="60" y="-82"/></transition><transition><source ref="id21"/><target ref="id18"/><label kind="guard" x="72" y="24">rpm &lt; 700</label><label kind="synchronisation" x="72" y="56">tik?</label><nail x="40" y="48"/></transition><transition><source ref="id21"/><target ref="id19"/><label kind="guard" x="80" y="-16">rpm &gt; 7000</label><label kind="synchronisation" x="80" y="-40">tik?</label></transition></template><system>// Place template instantiations here.
razeniTik = RazeniTik();
razeniSmycka = RazeniSmycka ();
motor = Motor();
motorTik = MotorTik();
motorEmergency = MotorEmergency();

// List one or more processes to be composed into a system.
system razeniTik, razeniSmycka, motor, motorTik, motorEmergency;</system></nta>